syntax = "proto3";

option csharp_namespace = "Users.Api.Grpc";
option go_package = "./;userclients";

package userclients;

enum ChannelType {
  TELEGRAM_BOT = 0;
  MOBILE_APP = 1;
  WEB_APP = 2;
}

// UserClient messages
message CreateUserClientRequest {
  string user_id = 1;
  ChannelType channel_type = 2;
  string telegram_id = 3;
  string chat_id = 4;
  string device_token = 5;
  string session_id = 6;
  string platform = 7;
  string version = 8;
  string language = 9;
}

message UpdateClientLastSeenRequest {
  string client_id = 1;
  string last_seen_at = 2;
}

// Response messages
message UserClientResponse {
  string id = 1;
  string user_id = 2;
  ChannelType channel_type = 3;
  string telegram_id = 4;
  string chat_id = 5;
  string device_token = 6;
  string session_id = 7;
  string platform = 8;
  string version = 9;
  string language = 10;
  bool is_active = 11;
  string created_at = 12;
  string last_seen_at = 13;
}

message UserClientSuccessResponse {
  bool success = 1;
  string message = 2;
}

message GetUserClientByIdRequest {
  string id = 1;
}

message GetUserClientByTelegramIdRequest {
  string telegram_id = 1;
}

message GetUserClientsRequest {
  string user_id = 1;
}

message GetActiveUserClientsRequest {
  string user_id = 1;
}

message UserClientsResponse {
  repeated UserClientResponse clients = 1;
}

message PatchUpdateUserClientRequest {
  string id = 1;
  bool is_active = 2;
  bool is_blocked = 3;
  string platform = 4;
  string language = 5;
  string version = 6;
  string last_seen_at = 7;
  string telegram_id = 8;
  string chat_id = 9;
  string device_token = 10;
  string session_id = 11;
}

// Service definition
service UserClientsService {
  rpc CreateClient (CreateUserClientRequest) returns (UserClientResponse);
  rpc UpdateClientLastSeen (UpdateClientLastSeenRequest) returns (UserClientSuccessResponse);
  rpc GetById (GetUserClientByIdRequest) returns (UserClientResponse);
  rpc GetByTelegramId (GetUserClientByTelegramIdRequest) returns (UserClientResponse);
  rpc GetByUser (GetUserClientsRequest) returns (UserClientsResponse);
  rpc GetActiveByUser (GetActiveUserClientsRequest) returns (UserClientsResponse);
  rpc PatchUpdate (PatchUpdateUserClientRequest) returns (UserClientSuccessResponse);
} 